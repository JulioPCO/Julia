# Teste collocation
# Johannes Jaeschke
# 01.5.2019
using LinearAlgebra

colmat = [0.19681547722366  0.39442431473909 0.37640306270047;
         -0.06553542585020  0.29207341166523 0.51248582618842;
          0.02377097434822 -0.04154875212600 0.11111111111111]
radau  = [0.15505 0.64495 1.00000]

t=[0.155051; 0.644949; 1.]

M1 =   [1 t[1] t[1]^2;
        1 t[2] t[2]^2;
        1 t[3] t[3]^2]

M2 = [  t[1] 0.5*t[1]^2 1/3*t[1]^3;
        t[2] 0.5*t[2]^2 1/3*t[2]^3;
        t[3] 0.5*t[3]^2 1/3*t[3]^3]

M = M2*inv(M1)

x0=[5;5;5.0]
h=2.0
I=[1.0 0 0 ; 0 1 0; 0 0 1]
x=inv(I+h*M)*x0
